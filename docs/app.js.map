{"version":3,"sources":["webpack:///app.js","webpack:///./app.route.js","webpack:///./components/game.js","webpack:///./components/header.js","webpack:///./components/leaders.js","webpack:///./components/settings.js","webpack:///./services/modal.js","webpack:///./services/scramble.js","webpack:///./services/shuffle.js","webpack:///./services/stat.js","webpack:///./services/storage.js","webpack:///./app.js"],"names":["webpackJsonp","module","exports","__webpack_require__","routeConfig","$locationProvider","$routeProvider","when","template","otherwise","hashPrefix","Object","defineProperty","value","default","$inject","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","game","controller","GameCtrl","$scope","$timeout","$element","$document","modal","storage","scramble","shuffle","stat","this","$shuffle","$storage","getStorage","tileSize","Math","floor","getBoardSize","dimension","get","_this","getTiles","then","tiles","map","tile","position_x","x","position_y","y","on","keyDownHandler","off","stopGame","swapTiles","startGame","t1","t2","_this3","_ref","_ref2","isGameRunning","doMove","isWin","gameTime","getGameTime","movesCount","getMovesCount","openWin","username","saveResult","emptyBlock","find","canvas","XDistance","YDistance","XAllowMove","abs","YAllowMove","direction","scope","getDirection","keyCode","event","$apply","moveByKeyPress","$event","hammerDirection","console","log","header","HeaderCtrl","$location","path","leaders","LeadersCtrl","settings","SettingsCtrl","boardSize","_showNumber","showNumber","_highlightRightPlace","highlightRightPlace","updateDimensionPreview","isLoading","generate","ctx","context","getContext","width","height","clearRect","putImageData","getImageData","set","val","modalCtrl","score","$modal","time","open","backdrop","keyboard","windowClass","controllerAs","resolve","result","e","getImage","$q","deferred","defer","img","Image","onload","src","promise","imagePromiseCache","maxFontSize","j","ratio","margin","drawImage","strokeRect","fontSize","num","centerX","centerY","strokeStyle","font","textAlign","lineWidth","strokeText","toString","tileCanvas","document","createElement","tileCtx","w","h","equalX","equalY","drawNumber","toDataURL","arguments","undefined","_this2","imagePromise","push","getTileAsCanvas","drawImagePart","random","drawHighlight","arr","a","$interval","startingTime","timerHandler","Date","endingTime","len","cancel","$localStorage","$default","_interopRequireDefault","obj","__esModule","_angular","_angular2","_angularRoute","_angularRoute2","_angularHammer","_angularHammer2","_app","_app2","_scramble","_scramble2","_storage","_storage2","_shuffle","_shuffle2","_stat","_stat2","_modal","_modal2","_header","_header2","_game","_game2","_leaders","_leaders2","_settings","_settings2","config","service","component","bootstrap"],"mappings":"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","file":"app.js","sourcesContent":["webpackJsonp([0],[\n/* 0 */,\n/* 1 */,\n/* 2 */,\n/* 3 */,\n/* 4 */,\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = routeConfig;\nfunction routeConfig($locationProvider, $routeProvider) {\n  $routeProvider.when('/game', { template: '<game></game>' }).when('/leaders', { template: '<leaders></leaders>' }).when('/settings', { template: '<settings></settings>' }).otherwise('/game');\n  $locationProvider.hashPrefix('');\n}\n\nrouteConfig.$inject = ['$locationProvider', '$routeProvider'];\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar game = {\n  template: '\\n\\t\\t<div class=\"game\">\\n\\t\\t\\n      <div class=\"row\">\\n        <div class=\"small-12 columns\">\\n          <h1>Game</h1>\\n          <hr />\\n          <div class=\"game-board\" hm-panend=\"$ctrl.onPan($event)\">\\n            <div class=\"tile\" ng-repeat=\"tile in $ctrl.tiles track by $index\"\\n              ng-style=\"{ top: tile.position_y * $ctrl.tileSize + \\'px\\', left: tile.position_x * $ctrl.tileSize + \\'px\\' }\"\\n              ng-class=\"{ empty: tile.canvas === null }\"\\n              ng-click=\"$ctrl.moveByClick(tile)\">\\n              <!--hm-tap=\"$ctrl.moveByTap(tile)\"-->\\n              <img ng-src=\"{{ $ctrl.scramble.getImageFromTile(tile)}}\"\\n                   ng-style=\"{ width: $ctrl.tileSize, height: $ctrl.tileSize }\">\\n            </div>\\n          </div>\\n        </div>\\n      </div>\\n      \\n      <br />\\n    \\n      <div class=\"row\">\\n        <div class=\"small-12 columns text-center\">\\n          <button class=\"button radius\" ng-click=\"$ctrl.startGame()\" ng-if=\"!$ctrl.stat.isGameRunning()\">\\n            <i class=\"fa fa-play\" aria-hidden=\"true\"></i>\\n            Start Game\\n          </button>\\n          <button class=\"button radius\" ng-click=\"$ctrl.endGame()\" ng-if=\"$ctrl.stat.isGameRunning()\">\\n            <i class=\"fa fa-stop\" aria-hidden=\"true\"></i>\\n            Stop Game\\n          </button>\\n          \\n          <h4 ng-if=\"$ctrl.stat.isGameRunning()\">\\n            <span>dimension: {{ $ctrl.$storage.dimension }},</span>\\n            <span>time: {{ $ctrl.stat.getGameTime() }} sec,</span>\\n            <span>moves count: {{ $ctrl.stat.getMovesCount() }}</span>\\n          </h4>\\n        </div>\\n      </div>\\n      \\n    </div>\\n\\t',\n\n  controller: function () {\n    _createClass(GameCtrl, null, [{\n      key: '$inject',\n      get: function get() {\n        return ['$scope', '$timeout', '$element', '$document', 'modal', 'storage', 'scramble', 'shuffle', 'stat'];\n      }\n    }]);\n\n    function GameCtrl($scope, $timeout, $element, $document, modal, storage, scramble, shuffle, stat) {\n      _classCallCheck(this, GameCtrl);\n\n      this.$scope = $scope;\n      this.$timeout = $timeout;\n      this.$element = $element;\n      this.$document = $document;\n      this.modal = modal;\n      this.scramble = scramble;\n      this.$shuffle = shuffle;\n      this.stat = stat;\n      this.$storage = storage.getStorage();\n      this.tileSize = Math.floor(storage.getBoardSize() / this.$storage.dimension);\n    }\n\n    _createClass(GameCtrl, [{\n      key: '$onInit',\n      value: function $onInit() {\n        var _this = this;\n\n        this.scramble.getTiles().then(function (tiles) {\n          _this.tiles = tiles.map(function (tile) {\n            tile.position_x = tile.x;\n            tile.position_y = tile.y;\n            return tile;\n          });\n        });\n        this.$document.on('keydown', this.keyDownHandler(this));\n      }\n    }, {\n      key: '$onDestroy',\n      value: function $onDestroy() {\n        this.$document.off('keydown', this.keyDownHandler(this));\n        this.stat.stopGame();\n      }\n    }, {\n      key: 'startGame',\n      value: function startGame() {\n        var _this2 = this;\n\n        var pseudoShuffle = true;\n\n        if (pseudoShuffle) {\n          this.swapTiles(this.tiles[this.tiles.length - 1], this.tiles[this.tiles.length - 2]);\n        } else {\n          this.$shuffle.array(this.tiles.map(function (tile) {\n            return {\n              x: tile.position_x,\n              y: tile.position_y\n            };\n          })).map(function (p, i) {\n            _this2.tiles[i].position_x = p.x;\n            _this2.tiles[i].position_y = p.y;\n          });\n        }\n\n        this.stat.startGame();\n      }\n    }, {\n      key: 'endGame',\n      value: function endGame() {\n        for (var i = 0; i < this.tiles.length; i++) {\n          this.tiles[i].position_x = this.tiles[i].x;\n          this.tiles[i].position_y = this.tiles[i].y;\n        }\n\n        this.stat.stopGame();\n      }\n    }, {\n      key: 'swapTiles',\n      value: function swapTiles(t1, t2) {\n        var _this3 = this;\n\n        var _ref = [t2.position_x, t1.position_x];\n        t1.position_x = _ref[0];\n        t2.position_x = _ref[1];\n        var _ref2 = [t2.position_y, t1.position_y];\n        t1.position_y = _ref2[0];\n        t2.position_y = _ref2[1];\n\n        if (this.stat.isGameRunning()) {\n          this.stat.doMove();\n          if (this.stat.isWin(this.tiles)) {\n            this.stat.stopGame();\n            var dimension = this.$storage.dimension;\n            var gameTime = this.stat.getGameTime();\n            var movesCount = this.stat.getMovesCount();\n            this.modal.openWin(dimension, gameTime, movesCount).then(function (username) {\n              if (username) {\n                _this3.stat.saveResult(username, dimension, gameTime, movesCount);\n              }\n            });\n          }\n        }\n      }\n    }, {\n      key: 'moveByClick',\n      value: function moveByClick(tile) {\n        if (!this.stat.isGameRunning()) {\n          return;\n        }\n\n        var emptyBlock = this.tiles.find(function (tile) {\n          return tile.canvas === null;\n        });\n        if (emptyBlock) {\n          var XDistance = emptyBlock.position_x - tile.position_x;\n          var YDistance = emptyBlock.position_y - tile.position_y;\n          var XAllowMove = XDistance === 0 && Math.abs(YDistance) === 1;\n          var YAllowMove = YDistance === 0 && Math.abs(XDistance) === 1;\n\n          if (XAllowMove || YAllowMove) {\n            this.swapTiles(emptyBlock, tile);\n          }\n        }\n      }\n    }, {\n      key: 'moveByKeyPress',\n      value: function moveByKeyPress(direction) {\n        if (!this.stat.isGameRunning()) {\n          return;\n        }\n\n        var emptyBlock = this.tiles.find(function (tile) {\n          return tile.canvas === null;\n        });\n        var target = { x: emptyBlock.position_x, y: emptyBlock.position_y };\n        if (emptyBlock) {\n          switch (direction) {\n            case 'left':\n              target.x++;\n              break;\n            case 'top':\n              target.y++;\n              break;\n            case 'right':\n              target.x--;\n              break;\n            case 'bottom':\n              target.y--;\n              break;\n            default:\n              target = null;\n              break;\n          }\n        }\n\n        if (target) {\n          var tile = this.tiles.find(function (tile) {\n            return tile.position_x === target.x && tile.position_y === target.y;\n          });\n          if (tile) {\n            this.swapTiles(emptyBlock, tile);\n          }\n        }\n      }\n    }, {\n      key: 'keyDownHandler',\n      value: function keyDownHandler(scope) {\n        // arrow keys or WSAD\n        var getDirection = function getDirection(keyCode) {\n          switch (keyCode) {\n            case 37:\n            case 65:\n              return 'left';\n            case 38:\n            case 87:\n              return 'top';\n            case 39:\n            case 68:\n              return 'right';\n            case 40:\n            case 83:\n              return 'bottom';\n          }\n          return null;\n        };\n\n        return function (event) {\n          var direction = getDirection(event.keyCode);\n          if (direction) {\n            scope.$scope.$apply(function () {\n              scope.moveByKeyPress(direction);\n            });\n          }\n        };\n      }\n    }, {\n      key: 'onPan',\n      value: function onPan($event) {\n        // touch pan direction\n        var getDirection = function getDirection(hammerDirection) {\n          switch (hammerDirection) {\n            case 2:\n              return 'left';\n            case 8:\n              return 'top';\n            case 4:\n              return 'right';\n            case 16:\n              return 'bottom';\n          }\n          return null;\n        };\n        var direction = getDirection($event.direction);\n        if (direction) {\n          console.log($event);\n          this.moveByKeyPress(direction);\n        }\n      }\n    }]);\n\n    return GameCtrl;\n  }()\n};\n\nexports.default = game;\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar header = {\n  template: '\\n\\t\\t<div class=\"row\">\\n      <div class=\"small-12 columns\">\\n        <a href=\"#/game\" class=\"button radius\" ng-class=\"{ \\'secondary\\': !$ctrl.isCurrent(\\'/game\\') }\">\\n            <i class=\"fa fa-gamepad\" aria-hidden=\"true\"></i>\\n            <!---->\\n            Game\\n        </a>\\n        <a href=\"#/leaders\" class=\"button radius\" ng-class=\"{ \\'secondary\\': !$ctrl.isCurrent(\\'/leaders\\') }\">\\n            <!--<i class=\"fa fa-star\" aria-hidden=\"true\"></i>-->\\n            <i class=\"fa fa-trophy\" aria-hidden=\"true\"></i>\\n            Leaders\\n        </a>\\n        <a href=\"#/settings\" class=\"button radius info right\">\\n          <i class=\"fa fa-cog\" aria-hidden=\"true\"></i>\\n          Settings\\n        </a>\\n      </div>\\n\\t\\t</div>\\n\\t',\n\n  controller: function () {\n    _createClass(HeaderCtrl, null, [{\n      key: '$inject',\n      get: function get() {\n        return ['$location'];\n      }\n    }]);\n\n    function HeaderCtrl($location) {\n      _classCallCheck(this, HeaderCtrl);\n\n      this.$location = $location;\n    }\n\n    _createClass(HeaderCtrl, [{\n      key: 'isCurrent',\n      value: function isCurrent(path) {\n        return this.$location.path() === path;\n      }\n    }]);\n\n    return HeaderCtrl;\n  }()\n};\n\nexports.default = header;\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar leaders = {\n  template: '\\n\\t\\t<div class=\"row\">\\n      <div class=\"small-12 columns\">\\n        <h1>Leaders</h1>\\n        <hr />\\n        <ul>\\n            <li ng-repeat=\"score in $ctrl.$storage.score track by $index\">\\n                {{ score | json }}\\n            </li>\\n        </ul>\\n      </div>\\n\\t\\t</div>\\n\\t',\n\n  controller: function () {\n    _createClass(LeadersCtrl, null, [{\n      key: '$inject',\n      get: function get() {\n        return ['storage'];\n      }\n    }]);\n\n    function LeadersCtrl(storage) {\n      _classCallCheck(this, LeadersCtrl);\n\n      this.$storage = storage.getStorage();\n    }\n\n    return LeadersCtrl;\n  }()\n};\n\nexports.default = leaders;\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar settings = {\n  template: '\\n\\t\\t<div class=\"row settings\">\\n      <div class=\"small-12 columns\">\\n        <h1>Settings</h1>\\n        <hr />\\n        <div class=\"dimension-preview\" ng-if=\"!$ctrl.isLoading\">\\n            <canvas></canvas>\\n        </div>\\n        <div class=\"dimension-preview-loader\" ng-if=\"$ctrl.isLoading\">\\n            <i class=\"fa fa-refresh fa-spin fa-3x fa-fw\"></i>\\n        </div>\\n        <h2>\\n          <label>\\n            Board dimensions\\n            <input type=\"range\" min=\"2\" max=\"10\" ng-model=\"$ctrl.dimension\" ng-change=\"$ctrl.updateDimensionPreview()\">\\n            <span>{{ $ctrl.dimension }}</span>\\n          </label>\\n        </h2>\\n        <h2 ng-click=\"$ctrl.highlightRightPlace = !$ctrl.highlightRightPlace\">\\n          <label>\\n            <i class=\"fa fa-check-square-o\" aria-hidden=\"true\" ng-show=\"$ctrl.highlightRightPlace\"></i>\\n            <i class=\"fa fa-square-o\" aria-hidden=\"true\" ng-show=\"!$ctrl.highlightRightPlace\"></i>\\n            Highlight tile in right place (in this example used random color)\\n          </label>\\n        </h2>\\n        <h2 ng-click=\"$ctrl.showNumber = !$ctrl.showNumber\">\\n          <label>\\n            <i class=\"fa fa-check-square-o\" aria-hidden=\"true\" ng-show=\"$ctrl.showNumber\"></i>\\n            <i class=\"fa fa-square-o\" aria-hidden=\"true\" ng-show=\"!$ctrl.showNumber\"></i>\\n            Show Numbers\\n          </label>\\n        </h2>\\n       </div>\\n\\t\\t</div>\\n\\t',\n\n  controller: function () {\n    _createClass(SettingsCtrl, null, [{\n      key: '$inject',\n      get: function get() {\n        return ['$timeout', '$element', '$scope', 'storage', 'scramble'];\n      }\n    }]);\n\n    function SettingsCtrl($timeout, $element, $scope, storage, scramble) {\n      _classCallCheck(this, SettingsCtrl);\n\n      this.$timeout = $timeout;\n      this.$element = $element;\n      this.$scope = $scope;\n      this.scramble = scramble;\n      this.$storage = storage.getStorage();\n      this.boardSize = storage.getBoardSize();\n    }\n\n    _createClass(SettingsCtrl, [{\n      key: '$onInit',\n      value: function $onInit() {\n        this.dimension = this.$storage.dimension;\n        this._showNumber = this.$storage.showNumber;\n        this._highlightRightPlace = this.$storage.highlightRightPlace;\n        this.updateDimensionPreview();\n      }\n    }, {\n      key: 'updateDimensionPreview',\n      value: function updateDimensionPreview() {\n        var _this = this;\n\n        this.isLoading = true;\n        this.$storage.dimension = this.dimension;\n        this.scramble.generate(this.dimension, this._showNumber, this._highlightRightPlace).then(function (ctx) {\n          _this.isLoading = false;\n          return _this.$timeout(function () {\n            return ctx;\n          }, 0);\n        }).then(function (ctx) {\n          var canvas = _this.$element.find('canvas')[0];\n          var context = canvas.getContext('2d');\n          canvas.width = _this.boardSize;\n          canvas.height = _this.boardSize;\n          context.clearRect(0, 0, canvas.width, canvas.height);\n          context.putImageData(ctx.getImageData(0, 0, canvas.width, canvas.height), 0, 0);\n        });\n      }\n    }, {\n      key: 'highlightRightPlace',\n      get: function get() {\n        return this._highlightRightPlace;\n      },\n      set: function set(val) {\n        this._highlightRightPlace = val;\n        this.$storage.highlightRightPlace = val;\n        this.updateDimensionPreview();\n      }\n    }, {\n      key: 'showNumber',\n      get: function get() {\n        return this._showNumber;\n      },\n      set: function set(val) {\n        this._showNumber = val;\n        this.$storage.showNumber = val;\n        this.updateDimensionPreview();\n      }\n    }]);\n\n    return SettingsCtrl;\n  }()\n};\n\nexports.default = settings;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar modalCtrl = function () {\n  _createClass(modalCtrl, null, [{\n    key: '$inject',\n    get: function get() {\n      return ['score'];\n    }\n  }]);\n\n  function modalCtrl(score) {\n    _classCallCheck(this, modalCtrl);\n\n    this.score = score;\n  }\n\n  return modalCtrl;\n}();\n\nvar modal = function () {\n  _createClass(modal, null, [{\n    key: '$inject',\n    get: function get() {\n      return ['$modal'];\n    }\n  }]);\n\n  function modal($modal) {\n    _classCallCheck(this, modal);\n\n    this.$modal = $modal;\n  }\n\n  _createClass(modal, [{\n    key: 'openWin',\n    value: function openWin(dimension, time, movesCount) {\n      return this.$modal.open({\n        template: '\\n        <div>\\n          <h2>You win!</h2>\\n          <h4>Your result: </h4>\\n          <p>\\n            <span>dimension: <strong>{{ modalCtrl.score.dimension}}</strong></span>\\n            <span>time: <strong>{{ modalCtrl.score.time}}</strong> sec</span>\\n            <span>moves: <strong>{{ modalCtrl.score.movesCount}}</strong></span>\\n          </p>\\n          <h3>Please, enter your name</h3>\\n          <input type=\"text\" ng-model=\"modalCtrl.name\" style=\"font-size: 2em;\" autofocus />\\n          <button class=\"button\" ng-click=\"$close(modalCtrl.name)\">OK</button>\\n          <a class=\"close-reveal-modal\" ng-click=\"$dismiss()\">&#215;</a>\\n        </div>\\n      ',\n        backdrop: 'static',\n        keyboard: false,\n        windowClass: 'tiny',\n        controllerAs: 'modalCtrl',\n        controller: modalCtrl,\n        resolve: {\n          score: function score() {\n            return { dimension: dimension, time: time, movesCount: movesCount };\n          }\n        }\n      }).result.then(function (result) {\n        return result;\n      }, function (e) {\n        return e;\n      });\n    }\n  }]);\n\n  return modal;\n}();\n\nexports.default = modal;\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar getImage = function getImage($q) {\n  var deferred = $q.defer();\n  var img = new Image();\n  img.onload = function () {\n    deferred.resolve(this);\n  };\n  img.src = 'images/nature.jpg';\n  return deferred.promise;\n};\n\nvar scramble = function () {\n  _createClass(scramble, null, [{\n    key: '$inject',\n    get: function get() {\n      return ['$q', 'storage'];\n    }\n  }]);\n\n  function scramble($q, storage) {\n    _classCallCheck(this, scramble);\n\n    this.$q = $q;\n    this.$storage = storage.getStorage();\n    this.imagePromiseCache = null;\n    this.tiles = [];\n    this.maxFontSize = 72;\n  }\n\n  _createClass(scramble, [{\n    key: 'imagePromise',\n    value: function imagePromise() {\n      if (!this.imagePromiseCache) {\n        this.imagePromiseCache = getImage(this.$q);\n      }\n      return this.imagePromiseCache;\n    }\n  }, {\n    key: 'getTiles',\n    value: function getTiles() {\n      var _this = this;\n\n      if (this.tiles.length) {\n        return this.$q.when(this.tiles);\n      } else {\n        return this.generate(this.$storage.dimension, this.$storage.showNumber, this.$storage.highlightRightPlace).then(function () {\n          return _this.tiles;\n        });\n      }\n    }\n  }, {\n    key: 'drawImagePart',\n    value: function drawImagePart(ctx, img, i, j, tileSize, ratio, margin) {\n      ctx.drawImage(img, i * tileSize * ratio, // image-x\n      j * tileSize * ratio, // image-y\n      tileSize * ratio, // image-width\n      tileSize * ratio, // image-height\n      i * tileSize + margin, // canvas-x\n      j * tileSize + margin, // canvas-y\n      tileSize - margin * 2, // canvas-width\n      tileSize - margin * 2);\n    }\n  }, {\n    key: 'drawHighlight',\n    value: function drawHighlight(ctx, i, j, tileSize, margin) {\n      ctx.strokeRect(i * tileSize + margin, // canvas-x\n      j * tileSize + margin, // canvas-y\n      tileSize - margin * 2, // canvas-width\n      tileSize - margin * 2 // canvas-height\n      );\n    }\n  }, {\n    key: 'drawNumber',\n    value: function drawNumber(ctx, fontSize, num, centerX, centerY) {\n      var strokeStyle = ctx.strokeStyle;\n      ctx.font = fontSize + 'px Arial';\n      ctx.textAlign = 'center';\n      ctx.lineWidth = 1;\n      ctx.strokeStyle = 'black';\n      ctx.strokeText(num.toString(), centerX + 1, centerY + 1);\n      ctx.lineWidth = 1;\n      ctx.strokeStyle = strokeStyle;\n      ctx.strokeText(num.toString(), centerX, centerY);\n    }\n  }, {\n    key: 'getTileAsCanvas',\n    value: function getTileAsCanvas(img, i, j, tileSize, ratio, margin) {\n      var tileCanvas = document.createElement(\"canvas\");\n      var tileCtx = tileCanvas.getContext('2d');\n      tileCanvas.width = tileSize;\n      tileCanvas.height = tileSize;\n      tileCtx.clearRect(0, 0, tileCanvas.width, tileCanvas.height);\n      tileCtx.drawImage(img, i * tileSize * ratio, // image-x\n      j * tileSize * ratio, // image-y\n      tileSize * ratio, // image-width\n      tileSize * ratio, // image-height\n      margin, // canvas-x\n      margin, // canvas-y\n      tileSize - margin * 2, // canvas-width\n      tileSize - margin * 2);\n      return tileCanvas;\n    }\n  }, {\n    key: 'getImageFromTile',\n    value: function getImageFromTile(tile) {\n      if (tile.canvas) {\n        var margin = 3;\n        var w = tile.canvas.width;\n        var h = tile.canvas.height;\n\n        var canvas = document.createElement(\"canvas\");\n        var ctx = canvas.getContext('2d');\n\n        canvas.width = w;\n        canvas.height = h;\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        ctx.drawImage(tile.canvas, 0, 0, w, h, 0, 0, w, h);\n\n        if (this.$storage.highlightRightPlace) {\n          var equalX = tile.x === tile.position_x;\n          var equalY = tile.y === tile.position_y;\n          ctx.strokeStyle = equalX && equalY ? 'green' : 'red';\n          ctx.strokeRect(margin, margin, w - margin * 2, h - margin * 2);\n        } else {\n          ctx.strokeStyle = 'black';\n        }\n\n        if (this.$storage.showNumber) {\n          var fontSize = this.maxFontSize / this.$storage.dimension * 2;\n          var centerX = w / 2;\n          var centerY = h / 2 + fontSize / 2;\n          var num = tile.y * this.$storage.dimension + tile.x + 1;\n          this.drawNumber(ctx, fontSize, num, centerX, centerY);\n        }\n\n        return canvas.toDataURL();\n      } else {\n        return null;\n      }\n    }\n  }, {\n    key: 'generate',\n    value: function generate() {\n      var dimension = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 4;\n\n      var _this2 = this;\n\n      var showNumber = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var highlightRightPlace = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n      return this.imagePromise().then(function (img) {\n        _this2.tiles = [];\n\n        var previewSize = 480;\n        var margin = 3;\n        var tileSize = Math.floor(previewSize / dimension);\n        var ratio = img.width / previewSize;\n\n        var canvas = document.createElement(\"canvas\");\n        var ctx = canvas.getContext('2d');\n\n        canvas.width = previewSize;\n        canvas.height = previewSize;\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n        for (var i = 0; i < dimension; i++) {\n          for (var j = 0; j < dimension; j++) {\n            if (i === dimension - 1 && j === dimension - 1) {\n              _this2.tiles.push({ x: i, y: j, canvas: null });\n              continue;\n            }\n            _this2.tiles.push({ x: i, y: j, canvas: _this2.getTileAsCanvas(img, i, j, tileSize, ratio, margin) });\n            _this2.drawImagePart(ctx, img, i, j, tileSize, ratio, margin);\n            if (highlightRightPlace) {\n              ctx.strokeStyle = Math.random() > 0.5 ? 'red' : 'green';\n              _this2.drawHighlight(ctx, i, j, tileSize, margin);\n            } else {\n              ctx.strokeStyle = 'black';\n            }\n            if (showNumber) {\n              var fontSize = _this2.maxFontSize / dimension * 2;\n              var centerX = i * tileSize + tileSize / 2;\n              var centerY = j * tileSize + tileSize / 2 + fontSize / 2;\n              var num = j * dimension + i + 1;\n              _this2.drawNumber(ctx, fontSize, num, centerX, centerY);\n            }\n          }\n        }\n\n        return ctx;\n      });\n    }\n  }]);\n\n  return scramble;\n}();\n\nexports.default = scramble;\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar shuffle = function () {\n  function shuffle() {\n    _classCallCheck(this, shuffle);\n  }\n\n  _createClass(shuffle, [{\n    key: \"array\",\n    value: function array(arr) {\n      // http://stackoverflow.com/questions/6274339/how-can-i-shuffle-an-array\n      var shuffleArray = function shuffleArray(a) {\n        for (var i = a.length; i; i--) {\n          var j = Math.floor(Math.random() * i);\n          var _ref = [a[j], a[i - 1]];\n          a[i - 1] = _ref[0];\n          a[j] = _ref[1];\n        }\n        return a;\n      };\n      return shuffleArray(arr);\n    }\n  }]);\n\n  return shuffle;\n}();\n\nexports.default = shuffle;\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar stat = function () {\n  _createClass(stat, null, [{\n    key: '$inject',\n    get: function get() {\n      return ['$interval', 'storage'];\n    }\n  }]);\n\n  function stat($interval, storage) {\n    _classCallCheck(this, stat);\n\n    this.$interval = $interval;\n    this.$storage = storage.getStorage();\n    this.startingTime = null;\n    this.movesCount = 0;\n    this.timerHandler = null;\n  }\n\n  _createClass(stat, [{\n    key: 'startGame',\n    value: function startGame() {\n      var _this = this;\n\n      this.startingTime = +new Date();\n      this.endingTime = +new Date();\n      this.movesCount = 0;\n      this.timerHandler = this.$interval(function () {\n        _this.endingTime = +new Date();\n      }, 1000);\n    }\n  }, {\n    key: 'getMovesCount',\n    value: function getMovesCount() {\n      return this.movesCount;\n    }\n  }, {\n    key: 'getGameTime',\n    value: function getGameTime() {\n      return Math.floor((this.endingTime - this.startingTime) / 1000);\n    }\n  }, {\n    key: 'isGameRunning',\n    value: function isGameRunning() {\n      return !!this.timerHandler;\n    }\n  }, {\n    key: 'doMove',\n    value: function doMove() {\n      this.movesCount++;\n    }\n  }, {\n    key: 'isWin',\n    value: function isWin(tiles) {\n      var len = tiles.length;\n      for (var i = 0; i < len; i++) {\n        if (tiles[i].x !== tiles[i].position_x) {\n          return false;\n        }\n        if (tiles[i].y !== tiles[i].position_y) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }, {\n    key: 'stopGame',\n    value: function stopGame() {\n      this.$interval.cancel(this.timerHandler);\n      this.timerHandler = undefined;\n    }\n  }, {\n    key: 'saveResult',\n    value: function saveResult(username, dimension, gameTime, movesCount) {\n      var time = +new Date();\n      this.$storage.score.push({ username: username, dimension: dimension, gameTime: gameTime, movesCount: movesCount, time: time });\n    }\n  }]);\n\n  return stat;\n}();\n\nexports.default = stat;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar storage = function () {\n  _createClass(storage, null, [{\n    key: \"$inject\",\n    get: function get() {\n      return ['$localStorage'];\n    }\n  }]);\n\n  function storage($localStorage) {\n    _classCallCheck(this, storage);\n\n    this.$storage = $localStorage.$default({\n      dimension: 4, // standard value for 15-puzzle\n      showNumber: true,\n      highlightRightPlace: true,\n      score: [\n      // predefined results\n      { \"username\": \"Georgy\", \"dimension\": 4, \"gameTime\": 20, \"movesCount\": 10, \"time\": 1494096553227 }]\n    });\n  }\n\n  _createClass(storage, [{\n    key: \"getStorage\",\n    value: function getStorage() {\n      return this.$storage;\n    }\n  }, {\n    key: \"getBoardSize\",\n    value: function getBoardSize() {\n      // check $boardSize sass variable\n      return 480;\n    }\n  }]);\n\n  return storage;\n}();\n\nexports.default = storage;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 16 */,\n/* 17 */,\n/* 18 */,\n/* 19 */,\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n// libs\n\nvar _angular = __webpack_require__(0);\n\nvar _angular2 = _interopRequireDefault(_angular);\n\nvar _angularRoute = __webpack_require__(3);\n\nvar _angularRoute2 = _interopRequireDefault(_angularRoute);\n\nvar _angularHammer = __webpack_require__(2);\n\nvar _angularHammer2 = _interopRequireDefault(_angularHammer);\n\n__webpack_require__(1);\n\n__webpack_require__(4);\n\nvar _app = __webpack_require__(5);\n\nvar _app2 = _interopRequireDefault(_app);\n\nvar _scramble = __webpack_require__(11);\n\nvar _scramble2 = _interopRequireDefault(_scramble);\n\nvar _storage = __webpack_require__(14);\n\nvar _storage2 = _interopRequireDefault(_storage);\n\nvar _shuffle = __webpack_require__(12);\n\nvar _shuffle2 = _interopRequireDefault(_shuffle);\n\nvar _stat = __webpack_require__(13);\n\nvar _stat2 = _interopRequireDefault(_stat);\n\nvar _modal = __webpack_require__(10);\n\nvar _modal2 = _interopRequireDefault(_modal);\n\nvar _header = __webpack_require__(7);\n\nvar _header2 = _interopRequireDefault(_header);\n\nvar _game = __webpack_require__(6);\n\nvar _game2 = _interopRequireDefault(_game);\n\nvar _leaders = __webpack_require__(8);\n\nvar _leaders2 = _interopRequireDefault(_leaders);\n\nvar _settings = __webpack_require__(9);\n\nvar _settings2 = _interopRequireDefault(_settings);\n\n__webpack_require__(15);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// services\n_angular2.default.module('game', [_angularRoute2.default, _angularHammer2.default, 'ngStorage', 'mm.foundation']).config(_app2.default).service('scramble', _scramble2.default).service('storage', _storage2.default).service('shuffle', _shuffle2.default).service('stat', _stat2.default).service('modal', _modal2.default).component('header', _header2.default).component('game', _game2.default).component('leaders', _leaders2.default).component('settings', _settings2.default);\n\n// components\n\n\n// config\n\n\n// vendors\n\n\n_angular2.default.bootstrap(document, ['game']);\n\n/***/ })\n],[20]);\n\n\n// WEBPACK FOOTER //\n// app.js","export default  function routeConfig($locationProvider, $routeProvider) {\n  $routeProvider\n    .when('/game', {template: '<game></game>'})\n    .when('/leaders', {template: '<leaders></leaders>'})\n    .when('/settings', {template: '<settings></settings>'})\n    .otherwise('/game');\n  $locationProvider.hashPrefix('');\n}\n\nrouteConfig.$inject = ['$locationProvider', '$routeProvider'];\n\n\n// WEBPACK FOOTER //\n// ./app.route.js","const game = {\n  template: `\n\t\t<div class=\"game\">\n\t\t\n      <div class=\"row\">\n        <div class=\"small-12 columns\">\n          <h1>Game</h1>\n          <hr />\n          <div class=\"game-board\" hm-panend=\"$ctrl.onPan($event)\">\n            <div class=\"tile\" ng-repeat=\"tile in $ctrl.tiles track by $index\"\n              ng-style=\"{ top: tile.position_y * $ctrl.tileSize + 'px', left: tile.position_x * $ctrl.tileSize + 'px' }\"\n              ng-class=\"{ empty: tile.canvas === null }\"\n              ng-click=\"$ctrl.moveByClick(tile)\">\n              <!--hm-tap=\"$ctrl.moveByTap(tile)\"-->\n              <img ng-src=\"{{ $ctrl.scramble.getImageFromTile(tile)}}\"\n                   ng-style=\"{ width: $ctrl.tileSize, height: $ctrl.tileSize }\">\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <br />\n    \n      <div class=\"row\">\n        <div class=\"small-12 columns text-center\">\n          <button class=\"button radius\" ng-click=\"$ctrl.startGame()\" ng-if=\"!$ctrl.stat.isGameRunning()\">\n            <i class=\"fa fa-play\" aria-hidden=\"true\"></i>\n            Start Game\n          </button>\n          <button class=\"button radius\" ng-click=\"$ctrl.endGame()\" ng-if=\"$ctrl.stat.isGameRunning()\">\n            <i class=\"fa fa-stop\" aria-hidden=\"true\"></i>\n            Stop Game\n          </button>\n          \n          <h4 ng-if=\"$ctrl.stat.isGameRunning()\">\n            <span>dimension: {{ $ctrl.$storage.dimension }},</span>\n            <span>time: {{ $ctrl.stat.getGameTime() }} sec,</span>\n            <span>moves count: {{ $ctrl.stat.getMovesCount() }}</span>\n          </h4>\n        </div>\n      </div>\n      \n    </div>\n\t`,\n  \n  controller: class GameCtrl {\n    static get $inject() {\n      return ['$scope', '$timeout', '$element', '$document', 'modal', 'storage', 'scramble', 'shuffle', 'stat'];\n    }\n    \n    constructor($scope, $timeout, $element, $document, modal, storage, scramble, shuffle, stat) {\n      this.$scope = $scope;\n      this.$timeout = $timeout;\n      this.$element = $element;\n      this.$document = $document;\n      this.modal = modal;\n      this.scramble = scramble;\n      this.$shuffle = shuffle;\n      this.stat = stat;\n      this.$storage = storage.getStorage();\n      this.tileSize = Math.floor(storage.getBoardSize() / this.$storage.dimension);\n    }\n    \n    $onInit() {\n      this.scramble.getTiles().then((tiles) => {\n        this.tiles = tiles.map((tile) => {\n          tile.position_x = tile.x;\n          tile.position_y = tile.y;\n          return tile;\n        });\n      });\n      this.$document.on('keydown', this.keyDownHandler(this));\n    }\n    \n    $onDestroy() {\n      this.$document.off('keydown', this.keyDownHandler(this));\n      this.stat.stopGame();\n    };\n    \n    startGame() {\n      const pseudoShuffle = true;\n      \n      if (pseudoShuffle) {\n        this.swapTiles(\n          this.tiles[this.tiles.length - 1],\n          this.tiles[this.tiles.length - 2]\n        );\n      } else {\n        this.$shuffle.array(this.tiles.map((tile) => {\n          return {\n            x: tile.position_x,\n            y: tile.position_y\n          }\n        })).map((p, i) => {\n          this.tiles[i].position_x = p.x;\n          this.tiles[i].position_y = p.y;\n        });\n      }\n      \n      this.stat.startGame();\n    }\n    \n    endGame() {\n      for (let i = 0; i < this.tiles.length; i++) {\n        this.tiles[i].position_x = this.tiles[i].x;\n        this.tiles[i].position_y = this.tiles[i].y;\n      }\n      \n      this.stat.stopGame();\n    }\n    \n    swapTiles(t1, t2) {\n      [t1.position_x, t2.position_x] = [t2.position_x, t1.position_x];\n      [t1.position_y, t2.position_y] = [t2.position_y, t1.position_y];\n      if (this.stat.isGameRunning()) {\n        this.stat.doMove();\n        if (this.stat.isWin(this.tiles)) {\n          this.stat.stopGame();\n          const dimension = this.$storage.dimension;\n          const gameTime = this.stat.getGameTime();\n          const movesCount = this.stat.getMovesCount();\n          this.modal.openWin(dimension, gameTime, movesCount).then((username) => {\n            if (username) {\n              this.stat.saveResult(username, dimension, gameTime, movesCount);\n            }\n          });\n        }\n      }\n    }\n  \n    moveByClick(tile) {\n      if (!this.stat.isGameRunning()) {\n        return;\n      }\n      \n      let emptyBlock = this.tiles.find((tile) => tile.canvas === null);\n      if (emptyBlock) {\n        const XDistance = emptyBlock.position_x - tile.position_x;\n        const YDistance = emptyBlock.position_y - tile.position_y;\n        const XAllowMove = (XDistance === 0 && Math.abs(YDistance) === 1);\n        const YAllowMove = (YDistance === 0 && Math.abs(XDistance) === 1);\n        \n        if (XAllowMove || YAllowMove) {\n          this.swapTiles(emptyBlock, tile);\n        }\n      }\n    }\n    \n    moveByKeyPress(direction) {\n      if (!this.stat.isGameRunning()) {\n        return;\n      }\n      \n      let emptyBlock = this.tiles.find((tile) => tile.canvas === null);\n      let target = {x: emptyBlock.position_x, y: emptyBlock.position_y};\n      if (emptyBlock) {\n        switch (direction) {\n          case 'left':\n            target.x++;\n            break;\n          case 'top':\n            target.y++;\n            break;\n          case 'right':\n            target.x--;\n            break;\n          case 'bottom':\n            target.y--;\n            break;\n          default:\n            target = null;\n            break;\n        }\n      }\n      \n      if (target) {\n        let tile = this.tiles.find((tile) => tile.position_x === target.x && tile.position_y === target.y);\n        if (tile) {\n          this.swapTiles(emptyBlock, tile);\n        }\n      }\n    }\n    \n    keyDownHandler(scope) {\n      // arrow keys or WSAD\n      const getDirection = (keyCode) => {\n        switch (keyCode) {\n          case 37:\n          case 65:\n            return 'left';\n          case 38:\n          case 87:\n            return 'top';\n          case 39:\n          case 68:\n            return 'right';\n          case 40:\n          case 83:\n            return 'bottom';\n        }\n        return null;\n      };\n      \n      return function (event) {\n        let direction = getDirection(event.keyCode);\n        if (direction) {\n          scope.$scope.$apply(() => {\n            scope.moveByKeyPress(direction);\n          });\n        }\n      }\n    }\n    \n    onPan($event) {\n      // touch pan direction\n      const getDirection = (hammerDirection) => {\n        switch (hammerDirection) {\n          case 2:\n            return 'left';\n          case 8:\n            return 'top';\n          case 4:\n            return 'right';\n          case 16:\n            return 'bottom';\n        }\n        return null;\n      };\n      let direction = getDirection($event.direction);\n      if (direction) {\n        console.log($event);\n        this.moveByKeyPress(direction);\n      }\n    }\n  }\n};\n\nexport default game;\n\n\n\n// WEBPACK FOOTER //\n// ./components/game.js","const header = {\n  template: `\n\t\t<div class=\"row\">\n      <div class=\"small-12 columns\">\n        <a href=\"#/game\" class=\"button radius\" ng-class=\"{ 'secondary': !$ctrl.isCurrent('/game') }\">\n            <i class=\"fa fa-gamepad\" aria-hidden=\"true\"></i>\n            <!---->\n            Game\n        </a>\n        <a href=\"#/leaders\" class=\"button radius\" ng-class=\"{ 'secondary': !$ctrl.isCurrent('/leaders') }\">\n            <!--<i class=\"fa fa-star\" aria-hidden=\"true\"></i>-->\n            <i class=\"fa fa-trophy\" aria-hidden=\"true\"></i>\n            Leaders\n        </a>\n        <a href=\"#/settings\" class=\"button radius info right\">\n          <i class=\"fa fa-cog\" aria-hidden=\"true\"></i>\n          Settings\n        </a>\n      </div>\n\t\t</div>\n\t`,\n  \n  controller: class HeaderCtrl {\n    static get $inject() {\n      return ['$location'];\n    }\n    \n    constructor($location) {\n      this.$location = $location;\n    }\n    \n    isCurrent(path) {\n      return this.$location.path() === path;\n    }\n  }\n};\n\nexport default header;\n\n\n// WEBPACK FOOTER //\n// ./components/header.js","const leaders = {\n  template: `\n\t\t<div class=\"row\">\n      <div class=\"small-12 columns\">\n        <h1>Leaders</h1>\n        <hr />\n        <ul>\n            <li ng-repeat=\"score in $ctrl.$storage.score track by $index\">\n                {{ score | json }}\n            </li>\n        </ul>\n      </div>\n\t\t</div>\n\t`,\n  \n  controller: class LeadersCtrl {\n    static get $inject() {\n      return ['storage']\n    }\n    \n    constructor(storage) {\n      this.$storage = storage.getStorage();\n    }\n  }\n};\n\nexport default leaders;\n\n\n\n// WEBPACK FOOTER //\n// ./components/leaders.js","const settings = {\n  template: `\n\t\t<div class=\"row settings\">\n      <div class=\"small-12 columns\">\n        <h1>Settings</h1>\n        <hr />\n        <div class=\"dimension-preview\" ng-if=\"!$ctrl.isLoading\">\n            <canvas></canvas>\n        </div>\n        <div class=\"dimension-preview-loader\" ng-if=\"$ctrl.isLoading\">\n            <i class=\"fa fa-refresh fa-spin fa-3x fa-fw\"></i>\n        </div>\n        <h2>\n          <label>\n            Board dimensions\n            <input type=\"range\" min=\"2\" max=\"10\" ng-model=\"$ctrl.dimension\" ng-change=\"$ctrl.updateDimensionPreview()\">\n            <span>{{ $ctrl.dimension }}</span>\n          </label>\n        </h2>\n        <h2 ng-click=\"$ctrl.highlightRightPlace = !$ctrl.highlightRightPlace\">\n          <label>\n            <i class=\"fa fa-check-square-o\" aria-hidden=\"true\" ng-show=\"$ctrl.highlightRightPlace\"></i>\n            <i class=\"fa fa-square-o\" aria-hidden=\"true\" ng-show=\"!$ctrl.highlightRightPlace\"></i>\n            Highlight tile in right place (in this example used random color)\n          </label>\n        </h2>\n        <h2 ng-click=\"$ctrl.showNumber = !$ctrl.showNumber\">\n          <label>\n            <i class=\"fa fa-check-square-o\" aria-hidden=\"true\" ng-show=\"$ctrl.showNumber\"></i>\n            <i class=\"fa fa-square-o\" aria-hidden=\"true\" ng-show=\"!$ctrl.showNumber\"></i>\n            Show Numbers\n          </label>\n        </h2>\n       </div>\n\t\t</div>\n\t`,\n  \n  controller: class SettingsCtrl {\n    static get $inject() {\n      return ['$timeout', '$element', '$scope', 'storage', 'scramble'];\n    }\n    \n    constructor($timeout, $element, $scope, storage, scramble) {\n      this.$timeout = $timeout;\n      this.$element = $element;\n      this.$scope = $scope;\n      this.scramble = scramble;\n      this.$storage = storage.getStorage();\n      this.boardSize = storage.getBoardSize();\n    }\n    \n    $onInit() {\n      this.dimension = this.$storage.dimension;\n      this._showNumber = this.$storage.showNumber;\n      this._highlightRightPlace = this.$storage.highlightRightPlace;\n      this.updateDimensionPreview();\n    };\n    \n    get highlightRightPlace() {\n      return this._highlightRightPlace;\n    }\n    \n    set highlightRightPlace(val) {\n      this._highlightRightPlace = val;\n      this.$storage.highlightRightPlace = val;\n      this.updateDimensionPreview();\n    }\n    \n    get showNumber() {\n      return this._showNumber;\n    }\n    \n    set showNumber(val) {\n      this._showNumber = val;\n      this.$storage.showNumber = val;\n      this.updateDimensionPreview();\n    }\n    \n    updateDimensionPreview() {\n      this.isLoading = true;\n      this.$storage.dimension = this.dimension;\n      this.scramble.generate(this.dimension, this._showNumber, this._highlightRightPlace)\n        .then((ctx) => {\n          this.isLoading = false;\n          return this.$timeout(() => {\n            return ctx;\n          }, 0);\n        }).then((ctx) => {\n          let canvas = this.$element.find('canvas')[0];\n          let context = canvas.getContext('2d');\n          canvas.width = this.boardSize;\n          canvas.height = this.boardSize;\n          context.clearRect(0, 0, canvas.width, canvas.height);\n          context.putImageData(ctx.getImageData(0, 0, canvas.width, canvas.height), 0, 0);\n        }\n      );\n    }\n    \n  }\n};\n\nexport default settings;\n\n\n\n// WEBPACK FOOTER //\n// ./components/settings.js","class modalCtrl {\n  static get $inject() {\n    return ['score'];\n  }\n  \n  constructor(score) {\n    this.score = score;\n  }\n}\n\nexport default class modal {\n  \n  static get $inject() {\n    return ['$modal'];\n  }\n  \n  constructor($modal) {\n    this.$modal = $modal;\n  }\n  \n  openWin(dimension, time, movesCount) {\n    return this.$modal.open({\n      template: `\n        <div>\n          <h2>You win!</h2>\n          <h4>Your result: </h4>\n          <p>\n            <span>dimension: <strong>{{ modalCtrl.score.dimension}}</strong></span>\n            <span>time: <strong>{{ modalCtrl.score.time}}</strong> sec</span>\n            <span>moves: <strong>{{ modalCtrl.score.movesCount}}</strong></span>\n          </p>\n          <h3>Please, enter your name</h3>\n          <input type=\"text\" ng-model=\"modalCtrl.name\" style=\"font-size: 2em;\" autofocus />\n          <button class=\"button\" ng-click=\"$close(modalCtrl.name)\">OK</button>\n          <a class=\"close-reveal-modal\" ng-click=\"$dismiss()\">&#215;</a>\n        </div>\n      `,\n      backdrop: 'static',\n      keyboard: false,\n      windowClass: 'tiny',\n      controllerAs: 'modalCtrl',\n      controller: modalCtrl,\n      resolve: {\n        score: () => {\n          return {dimension, time, movesCount};\n        }\n      }\n    }).result.then(result => result, e => e);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./services/modal.js","const getImage = ($q) => {\n  const deferred = $q.defer();\n  let img = new Image();\n  img.onload = function () {\n    deferred.resolve(this);\n  };\n  img.src = 'images/nature.jpg';\n  return deferred.promise;\n};\n\nexport default class scramble {\n  \n  static get $inject() {\n    return ['$q', 'storage'];\n  }\n  \n  constructor($q, storage) {\n    this.$q = $q;\n    this.$storage = storage.getStorage();\n    this.imagePromiseCache = null;\n    this.tiles = [];\n    this.maxFontSize = 72;\n  }\n  \n  imagePromise() {\n    if (!this.imagePromiseCache) {\n      this.imagePromiseCache = getImage(this.$q);\n    }\n    return this.imagePromiseCache;\n  }\n  \n  getTiles() {\n    if (this.tiles.length) {\n      return this.$q.when(this.tiles);\n    } else {\n      return this.generate(\n        this.$storage.dimension,\n        this.$storage.showNumber,\n        this.$storage.highlightRightPlace\n      ).then(() => {\n        return this.tiles;\n      });\n    }\n  }\n  \n  drawImagePart(ctx, img, i, j, tileSize, ratio, margin) {\n    ctx.drawImage(img,\n      i * tileSize * ratio,     // image-x\n      j * tileSize * ratio,     // image-y\n      tileSize * ratio,         // image-width\n      tileSize * ratio,         // image-height\n      i * tileSize + margin,    // canvas-x\n      j * tileSize + margin,    // canvas-y\n      tileSize - (margin * 2),  // canvas-width\n      tileSize - (margin * 2),  // canvas-height\n    );\n  };\n  \n  drawHighlight(ctx, i, j, tileSize, margin) {\n    ctx.strokeRect(\n      i * tileSize + margin,    // canvas-x\n      j * tileSize + margin,    // canvas-y\n      tileSize - (margin * 2),  // canvas-width\n      tileSize - (margin * 2)   // canvas-height\n    );\n  };\n  \n  drawNumber(ctx, fontSize, num, centerX, centerY) {\n    const strokeStyle = ctx.strokeStyle;\n    ctx.font = fontSize + 'px Arial';\n    ctx.textAlign = 'center';\n    ctx.lineWidth = 1;\n    ctx.strokeStyle = 'black';\n    ctx.strokeText(num.toString(), centerX + 1, centerY + 1);\n    ctx.lineWidth = 1;\n    ctx.strokeStyle = strokeStyle;\n    ctx.strokeText(num.toString(), centerX, centerY);\n  }\n  \n  getTileAsCanvas(img, i, j, tileSize, ratio, margin) {\n    let tileCanvas = document.createElement(\"canvas\");\n    let tileCtx = tileCanvas.getContext('2d');\n    tileCanvas.width = tileSize;\n    tileCanvas.height = tileSize;\n    tileCtx.clearRect(0, 0, tileCanvas.width, tileCanvas.height);\n    tileCtx.drawImage(img,\n      i * tileSize * ratio,     // image-x\n      j * tileSize * ratio,     // image-y\n      tileSize * ratio,         // image-width\n      tileSize * ratio,         // image-height\n      margin,                   // canvas-x\n      margin,                   // canvas-y\n      tileSize - (margin * 2),  // canvas-width\n      tileSize - (margin * 2),  // canvas-height\n    );\n    return tileCanvas;\n  };\n  \n  getImageFromTile(tile) {\n    if (tile.canvas) {\n      const margin = 3;\n      const w = tile.canvas.width;\n      const h = tile.canvas.height;\n      \n      let canvas = document.createElement(\"canvas\");\n      let ctx = canvas.getContext('2d');\n      \n      canvas.width = w;\n      canvas.height = h;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.drawImage(tile.canvas, 0, 0, w, h, 0, 0, w, h);\n      \n      if (this.$storage.highlightRightPlace) {\n        const equalX = tile.x === tile.position_x;\n        const equalY = tile.y === tile.position_y;\n        ctx.strokeStyle = (equalX && equalY) ? 'green' : 'red';\n        ctx.strokeRect(margin, margin, w - (margin * 2), h - (margin * 2));\n      } else {\n        ctx.strokeStyle = 'black';\n      }\n      \n      if (this.$storage.showNumber) {\n        const fontSize = (this.maxFontSize / this.$storage.dimension) * 2;\n        const centerX = (w / 2);\n        const centerY = (h / 2) + (fontSize / 2);\n        const num = ((tile.y * this.$storage.dimension) + tile.x) + 1;\n        this.drawNumber(ctx, fontSize, num, centerX, centerY);\n      }\n      \n      return canvas.toDataURL();\n    } else {\n      return null;\n    }\n  }\n  \n  generate(dimension = 4, showNumber = true, highlightRightPlace = true) {\n    return this.imagePromise().then((img) => {\n        this.tiles = [];\n        \n        const previewSize = 480;\n        const margin = 3;\n        const tileSize = Math.floor(previewSize / dimension);\n        const ratio = img.width / previewSize;\n        \n        let canvas = document.createElement(\"canvas\");\n        let ctx = canvas.getContext('2d');\n        \n        canvas.width = previewSize;\n        canvas.height = previewSize;\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        \n        for (let i = 0; i < dimension; i++) {\n          for (let j = 0; j < dimension; j++) {\n            if (i === dimension - 1 && j === dimension - 1) {\n              this.tiles.push({x: i, y: j, canvas: null});\n              continue;\n            }\n            this.tiles.push({x: i, y: j, canvas: this.getTileAsCanvas(img, i, j, tileSize, ratio, margin)});\n            this.drawImagePart(ctx, img, i, j, tileSize, ratio, margin);\n            if (highlightRightPlace) {\n              ctx.strokeStyle = (Math.random() > 0.5) ? 'red' : 'green';\n              this.drawHighlight(ctx, i, j, tileSize, margin);\n            } else {\n              ctx.strokeStyle = 'black';\n            }\n            if (showNumber) {\n              const fontSize = (this.maxFontSize / dimension) * 2;\n              const centerX = (i * tileSize) + (tileSize / 2);\n              const centerY = (j * tileSize) + (tileSize / 2) + (fontSize / 2);\n              const num = ((j * dimension) + i) + 1;\n              this.drawNumber(ctx, fontSize, num, centerX, centerY);\n            }\n          }\n        }\n        \n        return ctx;\n      }\n    );\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./services/scramble.js","export default class shuffle {\n  array(arr) {\n    // http://stackoverflow.com/questions/6274339/how-can-i-shuffle-an-array\n    const shuffleArray = (a) => {\n      for (let i = a.length; i; i--) {\n        let j = Math.floor(Math.random() * i);\n        [a[i - 1], a[j]] = [a[j], a[i - 1]];\n      }\n      return a;\n    };\n    return shuffleArray(arr);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./services/shuffle.js","export default class stat {\n  \n  static get $inject() {\n    return ['$interval', 'storage'];\n  }\n  \n  constructor($interval, storage) {\n    this.$interval = $interval;\n    this.$storage = storage.getStorage();\n    this.startingTime = null;\n    this.movesCount = 0;\n    this.timerHandler = null;\n  }\n  \n  startGame() {\n    this.startingTime = +new Date();\n    this.endingTime = +new Date();\n    this.movesCount = 0;\n    this.timerHandler = this.$interval(() => {\n      this.endingTime = +new Date();\n    }, 1000);\n  }\n  \n  getMovesCount() {\n    return this.movesCount;\n  }\n  \n  getGameTime() {\n    return Math.floor((this.endingTime - this.startingTime) / 1000);\n  }\n  \n  isGameRunning() {\n    return !!this.timerHandler;\n  }\n  \n  doMove() {\n    this.movesCount++;\n  }\n  \n  isWin(tiles) {\n    const len = tiles.length;\n    for (let i = 0; i < len; i++) {\n      if (tiles[i].x !== tiles[i].position_x) {\n        return false;\n      }\n      if (tiles[i].y !== tiles[i].position_y) {\n        return false;\n      }\n    }\n    return true;\n  }\n  \n  stopGame() {\n    this.$interval.cancel(this.timerHandler);\n    this.timerHandler = undefined;\n  }\n  \n  saveResult(username, dimension, gameTime, movesCount) {\n    const time = +new Date();\n    this.$storage.score.push({username, dimension, gameTime, movesCount, time});\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./services/stat.js","export default class storage {\n  \n  static get $inject() {\n    return ['$localStorage'];\n  }\n  \n  constructor($localStorage) {\n    this.$storage = $localStorage.$default({\n      dimension: 4,  // standard value for 15-puzzle\n      showNumber: true,\n      highlightRightPlace: true,\n      score: [\n        // predefined results\n        { \"username\": \"Georgy\", \"dimension\": 4, \"gameTime\": 20, \"movesCount\": 10, \"time\": 1494096553227 }\n      ]\n    });\n  }\n  \n  getStorage() {\n    return this.$storage;\n  }\n  \n  getBoardSize() {\n    // check $boardSize sass variable\n    return 480;\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./services/storage.js","'use strict';\n\n// libs\nimport angular from 'angular';\nimport ngRoute from 'angular-route';\nimport hmTouchEvents from 'angular-hammer';\n\n// vendors\nimport 'angular-foundation/mm-foundation-tpls.js';\nimport 'ngstorage/ngStorage.min';\n\n// config\nimport RouteConfig from './app.route';\n\n// services\nimport scramble from './services/scramble';\nimport storage from './services/storage';\nimport shuffle from './services/shuffle';\nimport stat from './services/stat';\nimport modal from './services/modal';\n\n// components\nimport header  from './components/header';\nimport game    from './components/game';\nimport leaders from './components/leaders';\nimport settings from './components/settings';\n\nimport './app.scss';\n\nangular.module('game', [ngRoute, hmTouchEvents, 'ngStorage', 'mm.foundation'])\n  .config(RouteConfig)\n  .service('scramble', scramble)\n  .service('storage', storage)\n  .service('shuffle', shuffle)\n  .service('stat', stat)\n  .service('modal', modal)\n  .component('header', header)\n  .component('game', game)\n  .component('leaders', leaders)\n  .component('settings', settings);\n\nangular.bootstrap(document, ['game']);\n\n\n\n// WEBPACK FOOTER //\n// ./app.js"],"sourceRoot":""}